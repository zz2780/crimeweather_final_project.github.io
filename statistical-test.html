<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistical test</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown-header">Project Report</li>
<li class="dropdown-header">Summary Visualizations</li>
<li class="dropdown-header">Model C</li>
<li class="dropdown-header">Model D</li>
<li class="dropdown-header">Interactive Map</li>
<li>
  <a href="https://github.com/zz2780/crimeweather_final_project.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:&lt;hw2861@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://spotcrime.com/">
    <span class="fa fa-solid fa-handcuffs"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical test</h1>

</div>


<div id="chi-squared-test-on-year-and-types-of-offense"
class="section level2">
<h2>Chi-squared test on year and types of offense</h2>
<p>We want to verify whether the number distribution of different crime
types is related to the year. Therefore we performed Chi-squared test
for comparison of year of 2016 and 2017 :</p>
<p><span class="math inline">\(H_0\)</span> : The number distribution of
each type of crime was the same in 2016 and 2017</p>
<p><span class="math inline">\(H_1\)</span> : The number distribution of
each type of crime was different in 2016 and 2017</p>
<pre class="r"><code>crime_weather &lt;- 
  crime_df %&gt;%
  group_by(date)%&gt;%
  summarise(total_crime = n())%&gt;%
  merge(weather_df,by = &quot;date&quot;)

df_1 &lt;- crime_df %&gt;%
  mutate (
    year = year(date)
  )%&gt;%
  group_by(year,offense) %&gt;%
  summarise(total_by_level = n()) %&gt;%
  pivot_wider(
    names_from = &quot;year&quot;,
    values_from = &quot;total_by_level&quot;
  )%&gt;%
  na.omit()
df_1 %&gt;%
  head() %&gt;%
  knitr::kable(digits = 3)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">offense</th>
<th align="right">2016</th>
<th align="right">2017</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">ADMINISTRATIVE CODE</td>
<td align="right">128</td>
<td align="right">117</td>
</tr>
<tr class="odd">
<td align="left">AGRICULTURE &amp; MRKTS LAW-UNCLASSIFIED</td>
<td align="right">8</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="left">ALCOHOLIC BEVERAGE CONTROL LAW</td>
<td align="right">9</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="left">ARSON</td>
<td align="right">87</td>
<td align="right">94</td>
</tr>
<tr class="even">
<td align="left">ASSAULT 3 &amp; RELATED OFFENSES</td>
<td align="right">6881</td>
<td align="right">6833</td>
</tr>
</tbody>
</table>
<pre class="r"><code>chisq.test(table(df_1$`2016`, df_1 $`2017`))</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  table(df_1$`2016`, df_1$`2017`)
## X-squared = 2206.1, df = 2068, p-value = 0.01734</code></pre>
<p>As the result told us, the p-value &lt; 0.05 , therefore we reject
the null hypothesis and conclude that the distribution of number of
different type of crime cases are different in 2016 and 2017.</p>
</div>
<div
id="chi-squared-test-on-borough-and-number-of-different-types-of-offense"
class="section level2">
<h2>Chi-squared test on Borough and number of different types of
offense</h2>
<p>We also want to know whether the distribution of number of different
type of crime cases across different borough are the same. Therefore, we
performed another Chi-squared test on number of different type of crimes
and borough. Because the population of Staten Island is small, so we did
not take it into consideration.</p>
<p><span class="math inline">\(H_0\)</span> : The number distribution of
each type of crime was the same in different boroughs.</p>
<p><span class="math inline">\(H_1\)</span> : The number distribution of
each type of crime was different in different boroughs.</p>
<pre class="r"><code>crime_df_3 &lt;- crime_df %&gt;%
  group_by(borough, offense)%&gt;%
  summarise(
    number = n()
  ) %&gt;%
  filter(borough %in% c(&quot;BRONX&quot;, &quot;BROOKLYN&quot;,&quot;MANHATTAN&quot;, &quot;QUEENS&quot;)) %&gt;%
  pivot_wider(
    names_from = &quot;borough&quot;,
    values_from = &quot;number&quot;
  )
crime_df_3%&gt;%
  head()%&gt;%
  knitr::kable(digits = 3)</code></pre>
<table>
<colgroup>
<col width="53%" />
<col width="8%" />
<col width="13%" />
<col width="14%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">offense</th>
<th align="right">BRONX</th>
<th align="right">BROOKLYN</th>
<th align="right">MANHATTAN</th>
<th align="right">QUEENS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">ADMINISTRATIVE CODE</td>
<td align="right">55</td>
<td align="right">104</td>
<td align="right">18</td>
<td align="right">60</td>
</tr>
<tr class="odd">
<td align="left">AGRICULTURE &amp; MRKTS LAW-UNCLASSIFIED</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">ALCOHOLIC BEVERAGE CONTROL LAW</td>
<td align="right">11</td>
<td align="right">10</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">ARSON</td>
<td align="right">48</td>
<td align="right">54</td>
<td align="right">29</td>
<td align="right">37</td>
</tr>
<tr class="even">
<td align="left">ASSAULT 3 &amp; RELATED OFFENSES</td>
<td align="right">3608</td>
<td align="right">4100</td>
<td align="right">2767</td>
<td align="right">2675</td>
</tr>
</tbody>
</table>
<pre class="r"><code>chisq.test(crime_df_3$BRONX,crime_df_3$BROOKLYN, crime_df_3$MANHATTAN, crime_df_3$QUEENS)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  crime_df_3$BRONX and crime_df_3$BROOKLYN
## X-squared = 1781.2, df = 1640, p-value = 0.008003</code></pre>
<p>We can see p-value is smaller than 0.05, so we reject the null
hypothesis and conclude that there’s at least one borough’s proportions
of violation counts for week days is different from others at 0.05
significant level.</p>
</div>
<div id="anova-between-number-of-crimes-per-day-and-weather"
class="section level2">
<h2>ANOVA between number of crimes per day and weather</h2>
<p>We also concerned about whether weather conditions will affect New
York City’s crime frequency per day. Therefore it is important to test
hypotheses according to different weather conditions and crime cases per
day.</p>
<p>At first, we divided the daily weather into four categories according
to whether the precipitation and rainfall are greater than 0.</p>
<pre class="r"><code>crime_weather_2 &lt;-  crime_weather %&gt;%
  mutate(weather = case_when(mean_prcp == 0 &amp; mean_snow == 0 ~ &#39;not_rainy_or_snowy&#39;,
                           mean_prcp &gt;0 &amp; mean_snow &gt;0 ~ &#39;rainy_and_snowy&#39;,
                           mean_prcp == 0 &amp; mean_snow &gt;0 ~ &#39;snowy&#39;,
                           mean_prcp &gt;0 &amp; mean_snow == 0 ~ &quot;rainy&quot;)) %&gt;%
  select(total_crime, weather)
crime_weather_2 %&gt;%
  head()%&gt;%
  knitr::kable(digits = 3)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">total_crime</th>
<th align="left">weather</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">347</td>
<td align="left">not_rainy_or_snowy</td>
</tr>
<tr class="even">
<td align="right">157</td>
<td align="left">not_rainy_or_snowy</td>
</tr>
<tr class="odd">
<td align="right">143</td>
<td align="left">not_rainy_or_snowy</td>
</tr>
<tr class="even">
<td align="right">159</td>
<td align="left">not_rainy_or_snowy</td>
</tr>
<tr class="odd">
<td align="right">139</td>
<td align="left">not_rainy_or_snowy</td>
</tr>
<tr class="even">
<td align="right">164</td>
<td align="left">not_rainy_or_snowy</td>
</tr>
</tbody>
</table>
<p>We then conducted one-way ANOVA to test if the true mean daily crime
cases of different weather is the same.</p>
<p><span class="math inline">\(H_0\)</span>: There is no difference in
the average number of crimes per day under different weather conditions
in New York.</p>
<p><span class="math inline">\(H_1\)</span>: At least the average number
of crimes per day under two different weather conditions are
different.</p>
<p>First, Let’s create box-plot of our data.</p>
<pre class="r"><code>ggplot(data = crime_weather_2, aes(x = weather, y = total_crime, fill = weather)) + geom_boxplot()</code></pre>
<p><img src="statistical-test_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<p>From the plot, the distribution of daily crime number seems different
in different weather.</p>
<p>And we conducted a ANOVA test</p>
<pre class="r"><code>res.aov &lt;- aov(total_crime ~ weather, data = crime_weather_2)
summary(res.aov) </code></pre>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## weather       3  31642   10547   14.46 3.72e-09 ***
## Residuals   727 530437     730                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>From the result, the p-value is smaller than 0.05, therefore we
concluded that the average number of crimes per day is correlated to
weather.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
